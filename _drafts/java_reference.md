---
title: java底层之引用
date: 2017-08-13 12:04:38
tags: [java,programming]
categories: programming
description: 
---
# 直接引用与符号引用

> **JVM运行类加载后， 在类的解析阶段，JVM会把类的二进制数据中的符号引用替换为直接引用。**
> java的底层代码运行时，在栈内存里实现对堆内存中数据的引用，以及引用在跨平台中的实现

<!--more-->

#### 符号引用：Symbolic References ####

- 以一组符号来描述 所引用的目标，而这个符号可以是任何形式的字面量，只要使用时可以无歧义定位到目标即可;
- 存在的原因：在编译阶段，java类并不知道所引用类的实际地址，只能使用符号来表示类的地址。而且在不同JVM实现的内存地址也不尽相同，经过符号引用这一道工序，同一个类，其符号引用必然一致；
- 类在解析过程中，就根据JVM实时产生的内存分配状况，将符号引用转为直接引用；

#### 直接引用：Direct References ####
**- 直接引用是和虚拟机的布局直接相关的，同一个符号引用在不同的JVM上翻译出来的直接引用也不尽相同。某个目标有了直接引用，那说明这个目标已经被加载到内存中了**

- 直接引用可以是：
	- 直接指向目标的指针（如，指向类型class对象、类变量、类方法的直接引用就是指向方法区的指针）；
	- 相对偏移量：如指向实例变量、实例方法的直接引用都是偏移量；
	- 一个能直接定位到目标的句柄；

----------
**Note:**
- *也就是说通过符号引用转换为直接引用来实现了引用的跨平台（对于同一个数据对象的引用都用同一个符号引用来实现，而在不同的平台上不同的JVM运行时转换成不同的直接引用）*