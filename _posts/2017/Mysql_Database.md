---
title: 关于数据库引擎的认识
date: 2017-09-01 12:23:30
categories: programming
tags: [programming,java,database,mysql]
keywords: 
---
# Mysql数据库
- mysql数据库引擎类别有：
	- ISAM：
		- 读取速度很快，不占用大量内存资源；
		- 不足之处：不支持事务，不能容错（如果硬盘崩溃，则不能恢复了）；
	- MYISAM：
		- Mysql的默认引擎，是ISAM的扩展格式，提供了ISAM没有的索引和字段管理功能外，还使用表格锁定的机制，达到人优化多个并发的读写操作，代价是要常用`OPTIMIZE TABLE`来恢复被更新机制浪费的空间。
		- MYISAM强调用ISAM所有的快速读取操作，这也让MYISAM在WEB开发中受到青睐；
	- HEAP：
		- HEAP允许只驻留在内存里的临时表格。驻留在内存里让HEAP要比ISAM和MYISAM都快，但是它所管理的数据是不稳定的，而且如果在关机之前没有进行保存，那么所有的数据都会丢失。
		- 在数据行被删除的时候，HEAP也不会浪费大量的空间。
		- HEAP表格在你需要使用SELECT表达式来选择和操控数据的时候非常有用。要记住，在用完表格之后就删除表格；
	- INNODB和BEAKLEYDB（BDB)：
		- INNODB和BERKLEYDB（BDB）数据库引擎都是造就MYSQL灵活性的技术的直接产品，这项技术就是MYSQL++ API。
		- 在使用MYSQL的时候，你所面对的每一个挑战几乎都源于ISAM和MYISAM数据库引擎不支持事务处理也不支持外键。
		- 尽管要比ISAM和MYISAM引擎慢很多，但是INNODB和BDB包括了对事务处理和外来键的支持，这两点都是前两个引擎所没有的。

<!--more-->

## 关于INNODB引擎：
**InnoDB:**
- Innodb引擎提供了对数据库ACID事务的支持，并且实现了SQL标准的四种隔离级别；
	- **ACID**
		- A  事务的原子性(Atomicity)：指一个事务要么全部执行,要么不执行.也就是说一个事务不可能只执行了一半就停止了.比如你从取款机取钱,这个事务可以分成两个步骤:1划卡,2出钱.不可能划了卡,而钱却没出来.这两步必须同时完成.要么就不完成.
		- C 事务的一致性(Consistency)：指事务的运行并不改变数据库中数据的一致性.例如,完整性约束了a+b=10,一个事务改变了a,那么b也应该随之改变.
		- I 独立性(Isolation）:事务的独立性也有称作隔离性,是指两个以上的事务不会出现交错执行的状态.因为这样可能会导致数据不一致.
		- D 持久性(Durability）:事务的持久性是指事务执行成功以后,该事务所对数据库所作的更改便是持久的保存在数据库之中，不会无缘无故的回滚.
	- 该引擎还提供了行级锁和外键约束，它的设计目标是**处理大容量数据库系统**，它本身其实就是基于MySQL后台的完整数据库系统，MySQL运行时Innodb会在内存中建立缓冲池，用于缓冲数据和索引。
- 与MYISAM相比：
	- MyIASM是MySQL**默认的引擎**，但是它没有提供对数据库事务的支持，也不支持行级锁和外键，因此当INSERT(插入)或UPDATE(更新)数据时即写操作需要锁定整个表，效率便会低一些。不过和Innodb不同，**MyIASM中存储了表的行数**，于是SELECT COUNT(*) FROM TABLE时只需要直接读取已经保存好的值而不需要进行全表扫描。
	- 如果表的**读操作远远多于写操作且不需要数据库事务的支持**，那么MyIASM也是很好的选择。
	- **大尺寸的数据集趋向于选择InnoDB引擎**，因为它支持事务处理和故障恢复。
	- 数据库的大小决定了故障恢复的时间长短，**InnoDB可以利用事务日志进行数据恢复**，这会比较快。
	- 主键查询在InnoDB引擎下也会相当快，不过需要注意的是如果主键太长也会导致性能问题，关于这个问题我会在下文中讲到。

## Index索引

> **索引（Index）是帮助MySQL高效获取数据的数据结构。**

- MyIASM和Innodb都使用了树这种数据结构做为索引。谈到树，就不得不谈到B-tree与B+tree；
- MyISAM引擎中用到的索引结构：
	- MyISAM引擎的索引结构为B+Tree，其中B+Tree的数据域存储的内容为实际数据的地址，也就是说它的**索引和实际的数据是分开的**，只不过是用索引指向了实际的数据，这种索引就是所谓的**非聚集索引**。
- Innodb引擎的索引结构：
	- 与MyISAM引擎的索引结构同样也是B+Tree，但是**Innodb的索引文件本身就是数据文件**，即**B+Tree的数据域存储的就是实际的数据**，这种索引就是**聚集索引**。
	- 这个索引的key就是数据表的主键，因此InnoDB表数据文件本身就是主索引。
	- 和MyISAM不同，InnoDB的辅助索引数据域存储的也是相应记录主键的值而不是地址，所以当以辅助索引查找时，会先根据辅助索引找到主键，再根据主键索引找到实际的数据。
	- 所以Innodb不建议使用过长的主键，否则会使辅助索引变得过大。建议使用自增的字段作为主键，这样B+Tree的每一个结点都会被顺序的填满，而不会频繁的分裂调整，会有效的提升插入数据的效率。
	- InnoDB的数据文件本身就是索引文件。从上文知道，MyISAM索引文件和数据文件是分离的，索引文件仅保存数据记录的地址。而在InnoDB中，表数据文件本身就是按B+Tree组织的一个索引结构，这棵树的叶节点data域保存了完整的数据记录。
	- 这个索引的key是数据表的主键，因此InnoDB表数据文件本身就是主索引。
- 这两种引擎都使用B+tree，不同之处在于：
	- MyISAM的的索引使用的是**非聚集索引**，而**InnoDB使用的是聚集索引**；
	- 所谓**非聚集索引就是索引与实际的数据是分开的**，索引只是指向了实际的数据；
	- **聚集索引指索引就是索引文件本身就是数据**，数据域存储的就是实际的数据；

----------
参考博客：http://www.cnblogs.com/0201zcr/p/5296843.html
